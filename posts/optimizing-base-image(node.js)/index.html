<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="[Docker] Docker 이미지 최적화(with Node.js) - (1/3)" /><meta property="og:locale" content="en" /><meta name="description" content="목차 Default node image Docker Hub options Slimer images Alpine images Distroless images Conclusion Reference" /><meta property="og:description" content="목차 Default node image Docker Hub options Slimer images Alpine images Distroless images Conclusion Reference" /><link rel="canonical" href="https://whdvlf94.github.io/posts/optimizing-base-image(node.js)/" /><meta property="og:url" content="https://whdvlf94.github.io/posts/optimizing-base-image(node.js)/" /><meta property="og:site_name" content="공간" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-08-17T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[Docker] Docker 이미지 최적화(with Node.js) - (1/3)" /><meta name="twitter:site" content="@" /><meta name="google-site-verification" content="5Exqr_GPVpsu_Ukny7OnZ0k_2nxPIenTtupKHZnB8Qg" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-08-17T20:42:44+09:00","datePublished":"2023-08-17T00:00:00+09:00","description":"목차 Default node image Docker Hub options Slimer images Alpine images Distroless images Conclusion Reference","headline":"[Docker] Docker 이미지 최적화(with Node.js) - (1/3)","mainEntityOfPage":{"@type":"WebPage","@id":"https://whdvlf94.github.io/posts/optimizing-base-image(node.js)/"},"url":"https://whdvlf94.github.io/posts/optimizing-base-image(node.js)/"}</script><title>[Docker] Docker 이미지 최적화(with Node.js) - (1/3) | 공간</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="공간"><meta name="application-name" content="공간"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/profile.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">공간</a></div><div class="site-subtitle font-italic">생각을 글로 옮겨적는 공간</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/whdvlf94" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['whdvlf04','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[Docker] Docker 이미지 최적화(with Node.js) - (1/3)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>[Docker] Docker 이미지 최적화(with Node.js) - (1/3)</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1692198000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 17, 2023 </em> </span> <span> Updated <em class="" data-ts="1692272564" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 17, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/whdvlf94">JongPil Yoon</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1704 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><h2 id="목차"><span class="mr-2">목차</span><a href="#목차" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li><a href="#1-default-node-image">Default node image</a><li><a href="#2-docker-hub-options-nodebuster-vs-nodebullseye">Docker Hub options</a><li><a href="#3-image-tag-for-slimmer-images">Slimer images</a><li><a href="#4-image-tag-for-alpine-images">Alpine images</a><li><a href="#5-distroless-docker-images-for-nodejs">Distroless images</a><li><a href="#6-conclusion">Conclusion</a><li><a href="#reference">Reference</a></ol><p><br /></p><p>이미지 크기와 취약성은 CI/CD 파이프라인 및 보안 태세에 큰 영향을 미칠 수 있기에 Base 이미지를 선택하는 것은 최적화를 위해 필요하다.</p><p><code class="language-plaintext highlighter-rouge">Node.js</code> 이미지 빌드 시 사용할 수 있는 옵션으로는 Core Node.js 팀에서 유지 관리하는 <strong>공식 Node.js 이미지</strong>, Docker Hub repository에서 제공하는 <strong>tag가 달린 이미지</strong>, Google에서 관리하는 <strong>distroless 이미지</strong> 등이 존재한다.</p><h1 id="1-default-node-image">1 Default node image</h1><blockquote><p>node</p></blockquote><p>Node.js Docker 팀에서 공식적으로 관리하며 여러 Docker Base 이미지 태그가 포함되어 있다. 해당 태그는 다양한 OS 버전(Debian, Ubuntu, Alpine 등)과 Node.js 런타임 자체에 매핑되는 여러 Docker Base 이미지 태그를 포함한다. 또한, amd64 또는 arm64x8(Apple M1)과 같은 CPU 아키텍처를 대상으로 하는 특정 버전 태그도 존재한다</p><div class="language-docker highlighter-rouge"><div class="code-header"> <span data-label-text="Docker"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">FROM</span><span class="s"> node</span>
</pre></table></code></div></div><p>위 이미지를 빌드하게 되면, <code class="language-plaintext highlighter-rouge">node:latest</code> 버전으로 설치가 진행되며, 이미지 크기는 1GB 이다. 해당 이미지에서 발생할 수 있는 종속성 및 보안 취약성은 다음과 같다.</p><ul><li><strong>총 409개의 종속성</strong>: <code class="language-plaintext highlighter-rouge">curl/libcurl4</code>, <code class="language-plaintext highlighter-rouge">git/git-man</code> 또는 <code class="language-plaintext highlighter-rouge">imagemagick/imagemagick-6-common</code>과 같은 운영 체제 패키지 관리자를 사용하였을 때 409개의 오픈 소스 라이브러리가 감지되었음<li><strong>총 289개의 보안 문제</strong>: 위 종속성 내에서 Buffer Overflows, Use After Free errors, Out-of-bounds Write 등 총 289개의 보안 문제가 발견되었음<li>Node.js 18.2.0 런타임 버전은 <a href="https://security.snyk.io/vuln/SNYK-UPSTREAM-NODE-2946423">DNS Rebinding</a>, <a href="https://security.snyk.io/vuln/SNYK-UPSTREAM-NODE-2946427">HTTP Request Smuggling</a>, <a href="https://security.snyk.io/vuln/SNYK-UPSTREAM-NODE-2946717">Configuration Hijacking</a> 등 7 가지 보안 문제에 취약함<li>또한, 해당 이미지 내에는 wget, git, curl과 같은 유틸리티가 default 로 설치되어 있다</ul><p><br /></p><h1 id="2-docker-hub-options-nodebuster-vs-nodebullseye">2 Docker Hub options node:buster vs node:bullseye</h1><blockquote><p>node:buster, node:bullseye</p></blockquote><p>Node.js Docker Hub 레포지토리에서 사용 가능한 태그를 찾아보면 <code class="language-plaintext highlighter-rouge">node:buster</code> , <code class="language-plaintext highlighter-rouge">node:bullseye</code>를 찾을 수 있다. 두 태그는 모두 Debian 배포 버전을 기반으로 하고 있으며, <strong>buster</strong> 태그는 24년에 종료되는 Debian 10에 매핑되므로 좋은 선택은 아니다. <strong>bullseye</strong> 태그는 26년 6월 경 종료되는 Debian 11(Current stable release)에 매핑되므로 bullseye 태그를 사용하는 것이 보다 더 적절하다(<a href="https://wiki.debian.org/LTS">Debian LTS</a>)</p><div class="language-docker highlighter-rouge"><div class="code-header"> <span data-label-text="Docker"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">FROM</span><span class="s"> node:bullseye</span>
</pre></table></code></div></div><p>하지만, 위 방식으로 이미지를 빌드하면 <code class="language-plaintext highlighter-rouge">node</code> 이미지와 완전하게 동일한 종속성 및 보안 취약성 결과가 나타난다. 이는 <code class="language-plaintext highlighter-rouge">node</code>, <code class="language-plaintext highlighter-rouge">node:buster</code>, <code class="language-plaintext highlighter-rouge">node:bullseye</code> 모두 동일한 Node.js 이미지 태그를 가리키기 때문이다.</p><p><br /></p><h1 id="3-image-tag-for-slimmer-images">3 Image tag for slimmer images</h1><blockquote><p>node:bullseye-slim</p></blockquote><p>slim이 포함된 이미지는 기본 태그에 포함된 공통 패키지를 포함하지 않으며 node를 실행하기 위한 최소한의 패키지만 포함한다.</p><div class="language-docker highlighter-rouge"><div class="code-header"> <span data-label-text="Docker"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">FROM</span><span class="s"> node:bullseye-slim</span>
</pre></table></code></div></div><p>위 이미지 크기는 약 245MB 이며, 콘텐츠를 스캔하면 97개의 종속성과 56개의 취약점이 나타난다. 기본 <code class="language-plaintext highlighter-rouge">node</code> 이미지와 비교해 보았을 때 이미지 크기 및 보안 태세 측면에서 더 나은 것을 확인할 수 있다.</p><p><br /></p><h1 id="4-image-tag-for-alpine-images">4 Image tag for alpine images</h1><blockquote><p>node:alpine</p></blockquote><p>alpine(Alpine Linux) 버전은 slim 버전 보다 더 작은 약 180MB 이하의 이미지 크기를 갖는다. 이는 소프트웨어 설치 공간이 더 작다는 것을 의미하고 이는 취약성으로 나타나는 부분이 더 적다는 것을 의미한다.</p><div class="language-docker highlighter-rouge"><div class="code-header"> <span data-label-text="Docker"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">FROM</span><span class="s"> node:alpine</span>
</pre></table></code></div></div><p>위 이미지의 콘텐츠를 스캔하였을 때, 총 16개의 운영 체제 종속성과 2개의 보안 취약점이 감지 되었으며 이는 <code class="language-plaintext highlighter-rouge">slim</code> 보다 이미지 크기 및 보안 태세 측면 모두에서 더 좋은 선택 임을 알 수 있다.</p><p><br /></p><p><strong>그렇다면</strong> <code class="language-plaintext highlighter-rouge">alpine</code> <strong>이 가장 최선의 선택인 걸까?</strong></p><p>이미지 크기 및 보안 태세 측면에서는 좋은 선택일 수 있다. 하지만, Alpine 프로젝트는 <strong>musl을 C 표준 라이브러리의 구현으로 사용</strong>하는 반면 <code class="language-plaintext highlighter-rouge">bullseye</code> <strong>또는</strong> <code class="language-plaintext highlighter-rouge">slim</code> <strong>과 같은 Debian의 Node.js 이미지 태그는</strong> <code class="language-plaintext highlighter-rouge">glibc</code> <strong>구현에 의존</strong>한다.</p><p>이러한 차이는 기본 C 라이브러리 차이로 인한 성능 문제, 기능적 버그 또는 잠재적인 응용 프로그램 충돌을 야기할 수도 있다. 뿐만 아니라, Node.js Docker 팀은 Alpine을 기반으로 하는 컨테이너 이미지 빌드를 공식적으로 지원하지 않는다. <strong>따라서, Alpine 기반 이미지 태그는 실험적이고 일관성이 부족할 수도 있게 때문에 운영(Production) 단계에서 사용하기에 적합하지 않다.</strong></p><blockquote><p>Node.js Unofficial Builds Project</p><p>Unofficial-builds attempts to provide basic Node.js binaries for some platforms that are either not supported or only partially supported by Node.js. This project does not provide any guarantees and its results are not rigorously tested. Builds made available at <a href="http://nodejs.org/">Node.js</a> have very high quality standards for code quality, support on the relevant platforms platforms and for timing and methods of delivery. Builds made available by unofficial-builds have minimal or no testing; the platforms may have no inclusion in the official Node.js test infrastructure. These builds are made available for the convenience of their user community but those communities are expected to assist in their maintenance.</p></blockquote><p><br /></p><h1 id="5-distroless-docker-images-for-nodejs">5 Distroless Docker Images for Node.js</h1><blockquote><p>gcr.io/distroless/nodejs:16</p></blockquote><p><code class="language-plaintext highlighter-rouge">distroless</code> 이미지는 애플리케이션과 해당 런타임 종속성만 대상으로 하기 때문에 <code class="language-plaintext highlighter-rouge">slim</code> 이미지 태그 보다 더 적은 용량을 차지한다. 즉, 컨테이너 패키지 매니저, 쉘 그리고 기타 범용 도구 종속성이 없으므로 작은 크기와 취약성을 띠고 있다.</p><div class="language-docker highlighter-rouge"><div class="code-header"> <span data-label-text="Docker"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">FROM</span><span class="s"> gcr.io/distroless/nodejs:16</span>
</pre></table></code></div></div><p><br /></p><p>Distroless 컨테이너 이미지에는 소프트웨어가 없기 때문에 Docker에서 Multi-stage 워크 플로우를 사용하여 컨테이너에 대한 종속성을 설치하고 이를 <code class="language-plaintext highlighter-rouge">distroless</code> 이미지에 복사하여 사용한다.</p><div class="language-docker highlighter-rouge"><div class="code-header"> <span data-label-text="Docker"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="k">FROM</span><span class="w"> </span><span class="s">node:16-bullseye-slim</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">build</span>
<span class="k">WORKDIR</span><span class="s"> /usr/src/app</span>
<span class="k">COPY</span><span class="s"> . /usr/src/app</span>
<span class="k">RUN </span>npm <span class="nb">install</span>

<span class="k">FROM</span><span class="s"> gcr.io/distroless/nodejs:16</span>
<span class="k">COPY</span><span class="s"> --from=build /usr/src/app /usr/src/app</span>
<span class="k">WORKDIR</span><span class="s"> /usr/src/app</span>
<span class="k">CMD</span><span class="s"> ["server.js"]</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">distroless</code> 이미지는 Debian 기반으로 되어 있으며, 안정적인 릴리즈(current stable release) 버전을 이미지로 제공한다. 하지만, 세분화된 Node.js 런타임 버전을 제공하지 않고 자주 업데이트되는 범용 <code class="language-plaintext highlighter-rouge">nodejs:16</code> 태그를 사용하거나 특정 시점의 SHA256 해시를 기반으로 설치해야 한다.</p><p><br /></p><h1 id="6-conclusion">6 Conclusion</h1><p>위 다양한 경우를 토대로 보았을 때, 가장 이상적인 Node.js Docker 이미지는 <strong>안정적(stable)</strong>이고 <strong>장기 지원 버전(active Long Term Support Version)</strong>이 있어야 하고, <strong>최신 Debian OS를 기반으로 하는 slim 버전</strong>이다.</p><div class="language-docker highlighter-rouge"><div class="code-header"> <span data-label-text="Docker"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">FROM</span><span class="s"> node:16-bullseye-slim</span>
</pre></table></code></div></div><p><br /></p><h1 id="reference">Reference</h1><hr /><ul><li><a href="https://snyk.io/blog/choosing-the-best-node-js-docker-image/">https://snyk.io/blog/choosing-the-best-node-js-docker-image/</a><li><a href="https://thearchivelog.dev/article/optimize-docker-image/">https://thearchivelog.dev/article/optimize-docker-image/</a><li><a href="https://github.com/vercel/next.js/discussions/16995">https://github.com/vercel/next.js/discussions/16995</a><li><a href="https://blog.alexellis.io/mutli-stage-docker-builds/">https://blog.alexellis.io/mutli-stage-docker-builds/</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/infra/'>Infra</a>, <a href='/categories/docker/'>Docker</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/docker/" class="post-tag no-text-decoration" >Docker</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"></div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%5BDocker%5D+Docker+%EC%9D%B4%EB%AF%B8%EC%A7%80+%EC%B5%9C%EC%A0%81%ED%99%94%28with+Node.js%29+-+%281%2F3%29+-+%EA%B3%B5%EA%B0%84&url=https%3A%2F%2Fwhdvlf94.github.io%2Fposts%2Foptimizing-base-image%28node.js%29%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%5BDocker%5D+Docker+%EC%9D%B4%EB%AF%B8%EC%A7%80+%EC%B5%9C%EC%A0%81%ED%99%94%28with+Node.js%29+-+%281%2F3%29+-+%EA%B3%B5%EA%B0%84&u=https%3A%2F%2Fwhdvlf94.github.io%2Fposts%2Foptimizing-base-image%28node.js%29%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fwhdvlf94.github.io%2Fposts%2Foptimizing-base-image%28node.js%29%2F&text=%5BDocker%5D+Docker+%EC%9D%B4%EB%AF%B8%EC%A7%80+%EC%B5%9C%EC%A0%81%ED%99%94%28with+Node.js%29+-+%281%2F3%29+-+%EA%B3%B5%EA%B0%84" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div><script src="https://utteranc.es/client.js" repo="whdvlf94/whdvlf94.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/best-practices-for-dockerfiles/">[Docker] Best practices for Dockerfile - (3/3)</a><li><a href="/posts/multi-stage-builds/">[Docker] Docker Multi-stage builds - (2/3)</a><li><a href="/posts/optimizing-base-image(node.js)/">[Docker] Docker 이미지 최적화(with Node.js) - (1/3)</a><li><a href="/posts/python-async/">[Python] Python 비동기 asyncio 사용하기</a><li><a href="/posts/python-server/">[Python] WSGI, ASGI</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/docker/">Docker</a> <a class="post-tag" href="/tags/architecture/">Architecture</a> <a class="post-tag" href="/tags/asgi/">ASGI</a> <a class="post-tag" href="/tags/asyncio/">asyncio</a> <a class="post-tag" href="/tags/blog/">Blog</a> <a class="post-tag" href="/tags/built-in/">built-in</a> <a class="post-tag" href="/tags/context-switching/">Context-Switching</a> <a class="post-tag" href="/tags/deadlock/">deadlock</a> <a class="post-tag" href="/tags/dockerfile/">Dockerfile</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/best-practices-for-dockerfiles/"><div class="card-body"> <em class="small" data-ts="1692198000" data-df="ll" > Aug 17, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Docker] Best practices for Dockerfile - (3/3)</h3><div class="text-muted small"><p> 목차 Layer 최적화 Docker 이미지 저장 방식 레이어 수 줄이기 명령문(Instructions) 정렬 패키지 최소화 애플리케이션 패키지 최소화 OS 패키지 최소화 Reference 1. Layer 수 최소화 1.1 Docker 이...</p></div></div></a></div><div class="card"> <a href="/posts/multi-stage-builds/"><div class="card-body"> <em class="small" data-ts="1692198000" data-df="ll" > Aug 17, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Docker] Docker Multi-stage builds - (2/3)</h3><div class="text-muted small"><p> 목차 Before multi-stage Builder pattern Multi-stage builds Multi-stage build example Multi-statge 유용한 기능들 빌드 단계 이름 지정 특정 빌드 단계에서 ...</p></div></div></a></div><div class="card"> <a href="/posts/python-async/"><div class="card-body"> <em class="small" data-ts="1683212400" data-df="ll" > May 5, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Python] Python 비동기 asyncio 사용하기</h3><div class="text-muted small"><p> 목차 Python WAS CGI, FastCGI WSGI ASGI Python 비동기란? 코루틴 네이티브 코루틴 GIL 이란? 왜 asyncio를 사용해야 하는가? asyncio 사용하기 async/await ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/multi-stage-builds/" class="btn btn-outline-primary" prompt="Older"><p>[Docker] Docker Multi-stage builds - (2/3)</p></a><div class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></div></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/whdvlf94">JongPil Yoon</a>.</p></div><div class="footer-right"><p class="mb-0"></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/docker/">Docker</a> <a class="post-tag" href="/tags/architecture/">Architecture</a> <a class="post-tag" href="/tags/asgi/">ASGI</a> <a class="post-tag" href="/tags/asyncio/">asyncio</a> <a class="post-tag" href="/tags/blog/">Blog</a> <a class="post-tag" href="/tags/built-in/">built-in</a> <a class="post-tag" href="/tags/context-switching/">Context-Switching</a> <a class="post-tag" href="/tags/deadlock/">deadlock</a> <a class="post-tag" href="/tags/dockerfile/">Dockerfile</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
